#!/usr/bin/env bash
# the shebang is ignored, but nice for editors
export VIRTUAL_ENV=."venv"
layout python


# Database
export DATABASE_URL="postgresql+asyncpg://postgres:postgres@localhost:25432/wedding_rsvp"
export DATABASE_URL_SYNC="postgresql://postgres:postgres@localhost:25432/wedding_rsvp"

# JWT
export SECRET_KEY="your-super-secret-key-change-in-production"
export ALGORITHM="HS256"
export ACCESS_TOKEN_EXPIRE_MINUTES=10080  # 7 days (60*24*7)

# Email
export SMTP_HOST="localhost"
export SMTP_PORT=11025
export SMTP_USER=""
export SMTP_PASSWORD=""
export EMAILS_FROM="wedding@example.com"

# App
export APP_HOST="0.0.0.0"
export APP_PORT=8000
export DEBUG=true
export FRONTEND_URL="http://localhost:4321"

# Frontend
export PUBLIC_BACKEND_API_URL="http://localhost:8000"

if type -P lorri &>/dev/null; then
  eval "$(lorri direnv)"
else
  echo 'while direnv evaluated .envrc, could not find the command "lorri" [https://github.com/nix-community/lorri]'
  # Use flake as primary development environment
  use flake

  # Fallback to traditional nix-shell if flake fails
  if [ $? -ne 0 ]; then
    echo 'Flake environment failed to load, falling back to nix-shell'
    use nix
  fi
fi
